# Урок 3. Описательная статистика и корреляция

## 1. Цель занятия

Освоить базовые методы анализа данных и научиться:
- считать меры центральной тенденции и разброса;
- оценивать устойчивость финансовых показателей;
- анализировать распределение и выявлять выбросы;
- оценивать взаимосвязь показателей через корреляцию;
- построить простую линейную регрессию и интерпретировать коэффициенты.

## 2. Обозначения и подготовка данных

Пусть есть выборка значений показателя: x1, x2, …, xn.  
n – количество наблюдений.

В Excel обычно используем диапазон (например, A2:A101).

Полезные функции:
- Количество наблюдений: `=СЧЁТ(A2:A101)` (числа) / `=СЧЁТЗ(A2:A101)` (непустые)
- Минимум/максимум: `=МИН(A2:A101)`, `=МАКС(A2:A101)`

## 3. Меры центральной тенденции

### 3.1 Среднее арифметическое (Mean)

Формула: `x̄ = (1/n) * Σ xi`

Excel: `=СРЗНАЧ(A2:A101)`

### 3.2 Взвешенное среднее

Нужно, когда наблюдения имеют «вес» (например, средняя цена с учетом объема продаж).

Формула: `x̄w = (Σ wi * xi) / (Σ wi)`

Excel (значения в B, веса в C): `=СУММПРОИЗВ(B2:B101;C2:C101)/СУММ(C2:C101)`

### 3.3 Медиана (Median)

Число, которое находится ровно посередине упорядоченного по возрастанию или убыванию набора данных, деля его на две равные части.

Excel: `=МЕДИАНА(A2:A101)`

### 3.4 Мода (Mode)

Значение, которое встречается в наборе данных (выборке) чаще других.

Excel: `=МОДА.ОДН(A2:A101)` (одна мода), `=МОДА.НСК(A2:A101)` (несколько мод, если применимо).

## 4. Меры разброса (вариации)

### 4.1 Размах (Range)

Формула: `R = xmax − xmin`

Excel: `=МАКС(A2:A101)-МИН(A2:A101)`

### 4.2 Дисперсия и стандартное отклонение

Выборочная дисперсия: `s² = Σ(xi − x̄)² / (n − 1)`

Генеральная дисперсия (если это «вся популяция»): `σ² = Σ(xi − μ)² / n`

Excel:
- Выборочная дисперсия: `=ДИСП.В(A2:A101)`
- Генеральная дисперсия: `=ДИСП.Г(A2:A101)`
- Стандартное отклонение (выборочное): `=СТАНДОТКЛОН.В(A2:A101)`
- Стандартное отклонение (генеральное): `=СТАНДОТКЛОН.Г(A2:A101)`

### 4.3 Коэффициент вариации (CV)

Формула:
`CV = s / x̄`
`CV% = (s / x̄) * 100%`

Excel: `=СТАНДОТКЛОН.В(A2:A101)/СРЗНАЧ(A2:A101)`, или в процентах: `=СТАНДОТКЛОН.В(A2:A101)/СРЗНАЧ(A2:A101)*100`

Интерпретация:
- CV менее 10% – низкая вариативность
- 10–30% – умеренная
- более 30% – высокая (метрика «шумная», прогноз хуже)

## 5. Квартильный анализ и выбросы (IQR)

### 5.1 Квартили

Excel:
- Q1: `=КВАРТИЛЬ.ВКЛ(A2:A101;1)`
- Q2 (медиана): `=КВАРТИЛЬ.ВКЛ(A2:A101;2)` или `=МЕДИАНА(...)`
- Q3: `=КВАРТИЛЬ.ВКЛ(A2:A101;3)`

### 5.2 Межквартильный размах

Формула: `IQR = Q3 − Q1`

Excel (если Q1 в E2, Q3 в E3): `=E3-E2`

### 5.3 Границы выбросов

Формулы:
- Нижняя граница = Q1 − 1.5 * IQR  
- Верхняя граница = Q3 + 1.5 * IQR

Excel:
- Нижняя: `=Q1-1,5*(Q3-Q1)`
- Верхняя: `=Q3+1,5*(Q3-Q1)`

### 5.4 Флаг выброса для строки

Пусть значение в A2, нижняя граница в F2, верхняя в F3:

- `=ЕСЛИ(ИЛИ(A2<$F$2;A2>$F$3);"выброс";"норма")`

## 6. Форма распределения: асимметрия и эксцесс

### 6.1 Асимметрия (Skewness)

Формула: `Skew = (1/n) * Σ((xi − x̄)/s)³`

Excel:
- `=СКОС(A2:A101)` (выборочная)
- `=СКОС.П(A2:A101)` (генеральная)

Интерпретация:
- Skew > 0 – правый «хвост» длиннее (часто у выручки/прибыли)
- Skew < 0 – левый «хвост» длиннее

### 6.2 Эксцесс (Kurtosis)

Формула: `Kurt = (1/n) * Σ((xi − x̄)/s)⁴ − 3`

Excel: `=ЭКСЦЕСС(A2:A101)`

Интерпретация:
- Kurt > 0 – «тяжёлые хвосты» (больше экстремальных значений)
- Kurt < 0 – распределение более «плоское»

## 7. Корреляция: взаимосвязь показателей

### 7.1 Ковариация

Формула: `cov(x,y) = Σ((xi − x̄)(yi − ȳ)) / (n − 1)`

Excel: `=КОВАРИАЦИЯ.В(A2:A101;B2:B101)`

### 7.2 Корреляция Пирсона

Формула: `r = cov(x,y) / (sx * sy)`

Excel: `=КОРРЕЛ(A2:A101;B2:B101)`

Интерпретация:
- r близко к 1 → сильная положительная линейная связь
- r близко к -1 → сильная отрицательная
- r близко к 0 → слабая линейная связь

Важно:
- корреляция ≠ причинность;
- выбросы могут «сломать» r;
- полезно проверять диаграммой рассеяния.

## 8. Простая линейная регрессия (базовая модель)

### 8.1 Модель

```y = a + b*x```

Где:
- x — фактор (например, рекламные расходы),
- y — результат (например, продажи).

### 8.2 Оценка коэффициентов (идея)

`b = cov(x,y) / sx²`

`a = ȳ − b*x̄`

### 8.3 Регрессия в Excel

Вариант A (быстро): функция ЛИНЕЙН
```=ЛИНЕЙН(B2:B101;A2:A101;ИСТИНА;ИСТИНА)```

Вариант B (наглядно): «Анализ данных → Регрессия»
- Данные → Анализ данных → Регрессия  
- Y Range: y  
- X Range: x  
- Галочки: «Метки» (если есть заголовки), «Residuals» (остатки)

Что смотреть в выходе:
- коэффициенты a и b
- R² (доля объясненной вариации)
- p-value (значимость коэффициентов)

### 8.4 Коэффициент детерминации

```R² = r²```
(для простой регрессии)

Интерпретация: R² = 0.6 → модель объясняет 60% разброса y.
