# Урок 6. Временные ряды и прогнозирование

## 1. Цель занятия

Освоить методы анализа динамики показателей во времени и научиться:

- выделять тренд и сезонность;
- строить модели сглаживания;
- рассчитывать прогноз;
- оценивать точность прогноза;
- интерпретировать результаты для финансового планирования.

## 2. Понятие временного ряда

Временной ряд – это последовательность значений показателя, упорядоченных по времени:

`Y1, Y2, Y3, …, Yt`

Где t – период (месяц, квартал, год).

## 3. Структура временного ряда

### 3.1 Аддитивная модель

`Yt = Tt + St + Et`

где:
- Tt – тренд (долгосрочное изменение);
- St – сезонность (повторяющиеся колебания);
- Et – случайная составляющая.

### 3.2 Мультипликативная модель

`Yt = Tt * St * Et`

Используется, если сезонность пропорциональна уровню ряда.

## 4. Тренд

### 4.1 Линейный тренд

`Yt = a + b*t`

где:
- b – скорость изменения показателя;
- a – уровень в начальный момент.

В Excel:
- Построить график → Добавить линию тренда → Линейная → Показать уравнение.

Или через функцию:
`=ЛИНЕЙН(значения;периоды)`

## 5. Скользящее среднее

Простое скользящее среднее (k периодов):

`MA = (Yt + Yt-1 + … + Yt-k+1) / k`

Excel (например, 3 периода):
`=СРЗНАЧ(B2:B4)`

Назначение:
- сглаживание краткосрочных колебаний;
- выявление тренда.

## 6. Экспоненциальное сглаживание

Формула:

`Ft = α*Yt-1 + (1 − α)*Ft-1`

где:
- Ft – прогноз;
- α – коэффициент сглаживания (0 < α < 1).

В Excel:

Данные → Анализ данных → Экспоненциальное сглаживание

Интерпретация:
- α ближе к 1 → модель сильнее реагирует на последние значения;
- α ближе к 0 → сильнее сглаживание.

## 7. Сезонность

### 7.1 Расчет сезонного индекса

Индекс сезона:

`St = Фактическое значение / Средний уровень`

### 7.2 Десезонирование

`Y* = Yt / St`

Позволяет анализировать чистый тренд.

## 8. Прогнозирование

### 8.1 Линейный прогноз

`Ŷt = a + b*t`

### 8.2 Прогноз с сезонностью

`Ŷt = (a + b*t) * St`

## 9. Ошибки прогноза

### 9.1 Абсолютная ошибка

`ei = Yi − Ŷi`

### 9.2 Средняя абсолютная ошибка (MAE)

`MAE = Σ|ei| / n`

### 9.3 Средняя абсолютная процентная ошибка (MAPE)

`MAPE = (1/n) * Σ(|ei| / Yi) * 100%`

### Excel

Абсолютная ошибка:
`=ABS(факт - прогноз)`

MAPE:
`=ABS((факт - прогноз)/факт)`
